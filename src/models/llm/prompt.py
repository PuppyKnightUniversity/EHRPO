subquestion_prompts = {
    "input": "Given a case and a question, please decompose the it into sub-questions. For each sub-question, please provide a concise and clear answer. When the original question is answerable, please start the subquestion with 'Now we can answer the question: '.\n",
    "few_shot": "\n<Case 1>:\nYou are a medical expert with extensive knowledge in analyzing electronic health records (EHR).\nThe structured temporal electronic health records (EHR) data is identified by <Visit Sequence>. It includes the patient's multiple visits to medical facilities, capturing diagnosed diseases, laboratory test information, and medication details.\nHere is the current patient's <Visit Sequence>:\n<Visit 1>:\n[conditions]:\nForeign body in esophagus\nForeign body accidentally entering other orifice\nDiaphragmatic hernia without mention of obstruction or gangrene\nUnspecified essential hypertension\n[procedures]:\nOther endoscopy of small intestine\n[drugs]:\nHYPNOTICS AND SEDATIVES\nANESTHETICS, GENERAL\nBETA BLOCKING AGENTS\nDRUGS FOR PEPTIC ULCER AND GASTRO-OESOPHAGEAL REFLUX DISEASE (GORD)\nOTHER ANALGESICS AND ANTIPYRETICS in ATC\n<Question>: How likely is the patient to be readmitted to the hospital within two weeks? Select one of the following options: A. >50%. B. <50%.\n<Sub-question 1>: What was the primary acute reason for this hospital visit?\n<Answer 1>: The primary acute reason appears to be a foreign body in the esophagus, which likely necessitated the endoscopic procedure.\n<Sub-question 2>: Do the other listed conditions (Diaphragmatic hernia, Hypertension) indicate a high likelihood of requiring acute care within two weeks?\n<Answer 2>: The diaphragmatic hernia is noted as being without obstruction or gangrene, suggesting it's a chronic or incidental finding, not an acute emergency. The hypertension is described as 'unspecified essential,' implying a chronic condition likely managed outpatiently. Neither condition, as described, strongly points towards an impending need for readmission.\n<Sub-question 3>: Now we can answer the question: How likely is the patient to be readmitted to the hospital within two weeks?\n<Answer 3>: B. <50%.\n\n<Case 2>:\nYou are a medical expert with extensive knowledge in analyzing electronic health records (EHR).\nThe structured temporal electronic health records (EHR) data is identified by <Visit Sequence>. It includes the patient's multiple visits to medical facilities, capturing diagnosed diseases, laboratory test information, and medication details.\nHere is the current patient's <Visit Sequence>:\n<Visit 1>:\n[conditions]:\nPostinflammatory pulmonary fibrosis\nUnspecified essential hypertension\nEsophageal reflux\n[procedures]:\n[drugs]:\nANTITHROMBOTIC AGENTS\nDRUGS FOR PEPTIC ULCER AND GASTRO-OESOPHAGEAL REFLUX DISEASE (GORD)\nDRUGS FOR CONSTIPATION\nEXPECTORANTS, EXCL. COMBINATIONS WITH COUGH SUPPRESSANTS\nANTACIDS\nCALCIUM SUPPLEMENTS\nVITAMIN A AND D, INCL. COMBINATIONS OF THE TWO\n<Question>: How likely is the patient to be readmitted to the hospital within two weeks? Select one of the following options: A. >50%. B. <50%.\n<Sub-question 1>: What are the main documented health conditions for this patient?\n<Answer 1>: The main documented conditions are chronic: Postinflammatory pulmonary fibrosis, unspecified essential hypertension, and esophageal reflux.\n<Sub-question 2>: Is there evidence of an acute medical event or exacerbation of chronic conditions during this visit based on the listed diagnoses?\n<Answer 2>: No, the listed conditions are chronic diagnoses without specific mention of acute exacerbation (e.g., no mention of acute respiratory failure, pneumonia, or hypertensive crisis).\n<Sub-question 3>: Now we can answer the question: How likely is the patient to be readmitted to the hospital within two weeks?\n<Answer 3>: B. <50%.\n",
    "subquestion_prefix": "\n<Sub-question {}>: ",
    "overall_question_prefix": {
        "readmission_prediction": "\n<Sub-question {}>: Now we can answer the question: How likely is the patient to be readmitted to the hospital within two weeks?",
        "mortality_prediction": "\n<Sub-question {}>: Now we can answer the question: How likely is the patient to die within the next 14 days?"
    },
    "answer_prefix": "\n<Answer {}>: ",
}
    
usefulness_prompts = {
    "input": "Given a case and some sub-questions, determine whether the last sub-question is significantly useful to answer the oribinal question. Output 'Yes' or 'No', and a reason.\n",
    "few_shot": "\n<Case 1>:\nYou are a medical expert with extensive knowledge in analyzing electronic health records (EHR).\nThe structured temporal electronic health records (EHR) data is identified by <Visit Sequence>. It includes the patient's multiple visits to medical facilities, capturing diagnosed diseases, laboratory test information, and medication details.\nHere is the current patient's <Visit Sequence>:\n<Visit 1>:\n[conditions]:\nForeign body in esophagus\nForeign body accidentally entering other orifice\nDiaphragmatic hernia without mention of obstruction or gangrene\nUnspecified essential hypertension\n[procedures]:\nOther endoscopy of small intestine\n[drugs]:\nHYPNOTICS AND SEDATIVES\nANESTHETICS, GENERAL\nBETA BLOCKING AGENTS\nDRUGS FOR PEPTIC ULCER AND GASTRO-OESOPHAGEAL REFLUX DISEASE (GORD)\nOTHER ANALGESICS AND ANTIPYRETICS in ATC\n<Question>: How likely is the patient to be readmitted to the hospital within two weeks? Select one of the following options: A. >50%. B. <50%.\n<Sub-question 1>: What was the primary acute reason for this hospital visit?\n<Answer 1>: The primary acute reason appears to be a foreign body in the esophagus, which likely necessitated the endoscopic procedure.\n<New sub-question 2>: Does this visit record indicate a high risk of needing further hospitalization in the short term?\nIs the new subquestion significantly useful? No. The new question essentially rephrases the original question, thus offering little distinct information to aid prediction.\n\n<Case 2>:\nYou are a medical expert with extensive knowledge in analyzing electronic health records (EHR).\nThe structured temporal electronic health records (EHR) data is identified by <Visit Sequence>. It includes the patient's multiple visits to medical facilities, capturing diagnosed diseases, laboratory test information, and medication details.\nHere is the current patient's <Visit Sequence>:\n<Visit 1>:\n[conditions]:\nPostinflammatory pulmonary fibrosis\nUnspecified essential hypertension\nEsophageal reflux\n[procedures]:\n[drugs]:\nANTITHROMBOTIC AGENTS\nDRUGS FOR PEPTIC ULCER AND GASTRO-OESOPHAGEAL REFLUX DISEASE (GORD)\nDRUGS FOR CONSTIPATION\nEXPECTORANTS, EXCL. COMBINATIONS WITH COUGH SUPPRESSANTS\nANTACIDS\nCALCIUM SUPPLEMENTS\nVITAMIN A AND D, INCL. COMBINATIONS OF THE TWO\n<Question>: How likely is the patient to be readmitted to the hospital within two weeks? Select one of the following options: A. >50%. B. <50%.\n<Sub-question 1>: What are the main documented health conditions for this patient?\n<Answer 1>: The main documented conditions are chronic: Postinflammatory pulmonary fibrosis, unspecified essential hypertension, and esophageal reflux.\n<Sub-question 2>: Is there evidence of an acute medical event or exacerbation of chronic conditions during this visit based on the listed diagnoses?\n<Answer 2>: No, the listed conditions are chronic diagnoses without specific mention of acute exacerbation (e.g., no mention of acute respiratory failure, pneumonia, or hypertensive crisis).\n<New sub-question 3>: Based on the documentation of stable chronic conditions without acute diagnoses or procedures during this visit, what is the likely risk profile for near-term readmission?\nIs the new subquestion significantly useful? No. The new sub-question merely restates information already covered in previous answers without providing additional clinical insights.\n",
    "subquestion_prefix": "\n<Sub-question {}>: ",
    "new_subquestion_prefix": "\n<New sub-question {}>: ",
    "useful_prefix": "\nIs the new subquestion significantly useful? ",
}

reward_prompts = {
    "input": "Given a case, some sub-questions, and their answers, please score the answer to the last sub-question from 0 to 100. A score of 100 means the answer is correct, accurate, and helps answer the original question. A score of 0 means the answer is completely wrong or unrelated to the original question.",
    "few_shot": "\n<Case 1>:\nYou are a medical expert with extensive knowledge in analyzing electronic health records (EHR).\nThe structured temporal electronic health records (EHR) data is identified by <Visit Sequence>. It includes the patient's multiple visits to medical facilities, capturing diagnosed diseases, laboratory test information, and medication details.\nHere is the current patient's <Visit Sequence>:\n<Visit 1>:\n[conditions]:\nForeign body in esophagus\nForeign body accidentally entering other orifice\nDiaphragmatic hernia without mention of obstruction or gangrene\nUnspecified essential hypertension\n[procedures]:\nOther endoscopy of small intestine\n[drugs]:\nHYPNOTICS AND SEDATIVES\nANESTHETICS, GENERAL\nBETA BLOCKING AGENTS\nDRUGS FOR PEPTIC ULCER AND GASTRO-OESOPHAGEAL REFLUX DISEASE (GORD)\nOTHER ANALGESICS AND ANTIPYRETICS in ATC\n<Question>: How likely is the patient to be readmitted to the hospital within two weeks? Select one of the following options: A. >50%. B. <50%.\n<Sub-question 1>: What was the primary acute reason for this hospital visit?\n<Answer 1>: The primary acute reason appears to be a foreign body in the esophagus, which likely necessitated the endoscopic procedure.\n<Sub-question 2>: Do the other listed conditions (Diaphragmatic hernia, Hypertension) indicate a high likelihood of requiring acute care within two weeks?\n<Answer 2>: Maybe. Hernias can sometimes need sudden surgery, and hypertension is about blood pressure. Blood pressure changes often. It depends on the patient.\nThe score is 24. The answer is vague and fails to analyze the specific, non-acute descriptions of the chronic conditions provided in the case.\n\n<Case 2>:\nYou are a medical expert with extensive knowledge in analyzing electronic health records (EHR).\nThe structured temporal electronic health records (EHR) data is identified by <Visit Sequence>. It includes the patient's multiple visits to medical facilities, capturing diagnosed diseases, laboratory test information, and medication details.\nHere is the current patient's <Visit Sequence>:\n<Visit 1>:\n[conditions]:\nPostinflammatory pulmonary fibrosis\nUnspecified essential hypertension\nEsophageal reflux\n[procedures]:\n[drugs]:\nANTITHROMBOTIC AGENTS\nDRUGS FOR PEPTIC ULCER AND GASTRO-OESOPHAGEAL REFLUX DISEASE (GORD)\nDRUGS FOR CONSTIPATION\nEXPECTORANTS, EXCL. COMBINATIONS WITH COUGH SUPPRESSANTS\nANTACIDS\nCALCIUM SUPPLEMENTS\nVITAMIN A AND D, INCL. COMBINATIONS OF THE TWO\n<Question>: How likely is the patient to be readmitted to the hospital within two weeks? Select one of the following options: A. >50%. B. <50%.\n<Sub-question 1>: What are the main documented health conditions for this patient?\n<Answer 1>: The main documented conditions are chronic: Postinflammatory pulmonary fibrosis, unspecified essential hypertension, and esophageal reflux.\n<Sub-question 2>: Is there evidence of an acute medical event or exacerbation of chronic conditions during this visit based on the listed diagnoses?\n<Answer 2>: The presence of pulmonary fibrosis alongside reflux could suggest underlying instability, even though no specific acute exacerbation is documented.\nThe score is 57. The answer inappropriately speculates about potential instability without documented acute evidence, deviating from the question's requirement for diagnosis-based assessment.\n",
    "reward_prefix": "\nThe score is ",
}